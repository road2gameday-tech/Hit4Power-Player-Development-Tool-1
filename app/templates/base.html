<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>{% block title %}Hit4Power{% endblock %}</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header class="app-header">
    <div class="header-left">
      <img src="/static/logo.svg" alt="Hit4Power" class="logo" onerror="this.style.display='none'">
      <span class="brand">Hit4Power</span>
      {% block header_title %}{% endblock %}
    </div>
    <div class="header-right">
      {% if request.session.get('instructor_id') or request.session.get('player_id') %}
      <a class="btn btn-red" href="/logout">Logout</a>
      {% endif %}
      <button id="themeBtn" class="btn btn-ghost">Theme</button>
    </div>
  </header>

  <main class="container">
    {% if request.session.get('create_success') %}
      <div class="banner success">
        {{ request.session.get('create_success') }}
      </div>
      {% set _ = request.session.pop('create_success') %}
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <script>
    // Theme toggle
    (function(){
      const key = 'h4p-theme';
      const root = document.documentElement;
      const saved = localStorage.getItem(key);
      if(saved){ root.setAttribute('data-theme', saved); }
      document.getElementById('themeBtn')?.addEventListener('click', ()=>{
        const next = root.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        root.setAttribute('data-theme', next);
        localStorage.setItem(key, next);
      });
    })();
  </script>
  {% block scripts %}{% endblock %}
</body>
</html>
